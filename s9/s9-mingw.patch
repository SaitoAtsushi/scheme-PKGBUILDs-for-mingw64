diff -u3 -r s9.org/ext/curses/curses.c s9/ext/curses/curses.c
--- s9.org/ext/curses/curses.c	2018-10-31 05:00:41.000000000 +0900
+++ s9/ext/curses/curses.c	2025-11-19 13:23:31.000944300 +0900
@@ -24,7 +24,11 @@
 #undef FALSE
 
 #include <stdlib.h>
-#include <curses.h>
+#ifdef __MINGW32__
+ #include <ncurses/ncurses.h>
+#else
+ #include <curses.h>
+#endif
 
 static int	Curses_running = 0;
 
diff -u3 -r s9.org/Makefile s9/Makefile
--- s9.org/Makefile	2025-08-12 18:37:48.000000000 +0900
+++ s9/Makefile	2025-11-20 17:03:22.805336000 +0900
@@ -11,23 +11,18 @@
 RELEASE=	20250812
 
 # Override default compiler and flags
-CC=	cc
-CFLAGS=	-g -Wall -std=c99 -pedantic -O2
+CC=	gcc
+CFLAGS=	-Wall -std=c99 -pedantic -O2 -Wno-address -Wno-stringop-truncation -Wno-format-overflow
+EXTRA_LIBS = -lShlwapi
 
 # Which OS are we using (unix or plan9)?
-OSDEF=	-Dunix
-
-# Uncomment these to include the Unix extensions
-EXTRA_SCM+=	-l ext/sys-unix/unix.scm -l ext/sys-unix/unix-tools.scm
-EXTRA_OBJS+=	unix.o
-EXTRA_INIT+=	sys_init();
-EXTRA_LIBS+=
+OSDEF=	
 
 # Uncomment these to include the Curses extensions
 EXTRA_SCM+=	-l ext/curses/curses.scm
 EXTRA_OBJS+=	curses.o
 EXTRA_INIT+=	curs_init();
-EXTRA_LIBS+=	-lncurses
+EXTRA_LIBS+=	`pkg-config --libs ncursesw`
 
 # Uncomment these to include the CSV extensions
 EXTRA_SCM+=	-l ext/csv/csv.scm
@@ -45,8 +40,6 @@
 #				# (requires the Curses extension)
 
 DEFS=	$(OSDEF) \
-	-DLIBRARY_PATH="\".:~/s9fes:$(S9DIR)\"" \
-	-DIMAGE_DIR="\"$(S9DIR)\"" \
 	-DEXTENSIONS="$(EXTRA_INIT)" \
 	-DNETWORK \
 	-DCURSES_COLOR \
@@ -60,16 +53,16 @@
 MANDIR=	$(PREFIX)/man/man1
 
 # Set up environment to be used during the build process
-BUILD_ENV=	env S9FES_LIBRARY_PATH=.:lib:ext/sys-unix:ext/curses:ext/csv:contrib S9FES_IMAGE_DIR=.
+BUILD_ENV=	env S9FES_LIBRARY_PATH=".;lib;ext/curses;ext/csv;contrib" S9FES_IMAGE_DIR=.
 
 SETPREFIX=	sed -e "s|^\#! /usr/local|\#! $(PREFIX)|"
 
-default:	s9 s9.image s9.1.gz s9.1.txt libs9core.a
+default:	s9.exe s9.image s9.1.gz s9.1.txt libs9core.a
 
 all:	default
 
-s9:	s9.o s9core.o $(EXTRA_OBJS)
-	$(CC) -o s9 $(LDFLAGS) s9.o s9core.o $(EXTRA_OBJS) $(EXTRA_LIBS)
+s9.exe:	s9.o s9core.o $(EXTRA_OBJS)
+	$(CC) -o s9.exe $(LDFLAGS) s9.o s9core.o $(EXTRA_OBJS) $(EXTRA_LIBS)
 
 s9.o:	s9.c s9core.h s9import.h s9ext.h
 	$(CC) -o s9.o $(CFLAGS) $(DEFS) -c s9.c
@@ -77,9 +70,9 @@
 s9core.o:	s9core.c s9core.h
 	$(CC) -o s9core.o $(CFLAGS) $(DEFS) -c s9core.c
 
-s9.image:	s9 s9.scm ext/sys-unix/unix.scm ext/curses/curses.scm \
+s9.image:	s9.exe s9.scm ext/sys-unix/unix.scm ext/curses/curses.scm \
 		ext/csv/csv.scm config.scm
-	$(BUILD_ENV) ./s9 -i - $(EXTRA_SCM) -l config.scm -d s9.image
+	$(BUILD_ENV) ./s9.exe -i - $(EXTRA_SCM) -l config.scm -d s9.image
 
 libs9core.a: s9core.o
 	ar q libs9core.a s9core.o
@@ -87,8 +80,8 @@
 s9.1.gz:	s9.1
 	sed -e "s,@S9DIR@,$(S9DIR)," <s9.1 |gzip -9 >s9.1.gz
 
-unix.o:	ext/sys-unix/unix.c s9core.h s9import.h s9ext.h
-	$(CC) $(CFLAGS) $(DEFS) -I . -o unix.o -c ext/sys-unix/unix.c
+#unix.o:	ext/sys-unix/unix.c s9core.h s9import.h s9ext.h
+#	$(CC) $(CFLAGS) $(DEFS) -I . -o unix.o -c ext/sys-unix/unix.c
 
 curses.o:	ext/curses/curses.c s9core.h s9import.h s9ext.h
 	$(CC) $(CFLAGS) $(DEFS) -I . -o curses.o -c ext/curses/curses.c
@@ -99,26 +92,26 @@
 lint:
 	cc -g -Wall -ansi -pedantic -O3 s9.c s9core.c && rm a.out
 
-test:	s9 test.image
-	$(BUILD_ENV) ./s9 -i test.image util/test.scm
+test:	s9.exe test.image
+	$(BUILD_ENV) ./s9.exe -i test.image util/test.scm
 
-libtest:	s9 test.image
+libtest:	s9.exe test.image
 	$(BUILD_ENV) sh util/libtest.sh
 
-systest:	s9 test.image s9.image
-	$(BUILD_ENV) ./s9 -i test.image util/systest.scm
+systest:	s9.exe test.image s9.image
+	$(BUILD_ENV) ./s9.exe -i test.image util/systest.scm
 
-srtest:	s9 test.image
-	$(BUILD_ENV) ./s9 -i test.image util/srtest.scm
+srtest:	s9.exe test.image
+	$(BUILD_ENV) ./s9.exe -i test.image util/srtest.scm
 
-realtest:	s9 test.image
-	$(BUILD_ENV) ./s9 -i test.image util/realtest.scm
+realtest:	s9.exe test.image
+	$(BUILD_ENV) ./s9.exe -i test.image util/realtest.scm
 
 coretest:	s9core.c s9core.h s9import.h
 	$(CC) $(CFLAGS) $(DEFS) -DTEST s9core.c && ./a.out && rm -f a.out
 
-test.image:	s9 s9.scm
-	$(BUILD_ENV) ./s9 -i - $(EXTRA_SCM) -d test.image
+test.image:	s9.exe s9.scm
+	$(BUILD_ENV) ./s9.exe -i - $(EXTRA_SCM) -d test.image
 
 tests: coretest test realtest srtest libtest systest
 
@@ -128,65 +121,64 @@
 
 # old version of install(1) may need -c
 #C=-c
-install-s9:	s9 s9.scm s9.image s9.1.gz libs9core.a
-	install -d -m 0755 $(S9DIR)
-	install -d -m 0755 $(S9DIR)/help
-	install -d -m 0755 $(S9DIR)/help/sys-unix
-	install -d -m 0755 $(S9DIR)/help/curses
-	install -d -m 0755 $(S9DIR)/help/csv
-	install -d -m 0755 $(BINDIR)
-	install -d -m 0755 $(LIBDIR)
-	install -d -m 0755 $(INCDIR)
-	install -d -m 0755 $(MANDIR)
-	install $C -m 0755 s9 $(BINDIR)
-	strip $(BINDIR)/s9
-	install $C -m 0644 s9.scm $(S9DIR)
-	install $C -m 0644 s9.image $(S9DIR)
-	install $C -m 0644 lib/* $(S9DIR)
-	install $C -m 0644 ext/sys-unix/*.scm $(S9DIR)
-	install $C -m 0644 ext/curses/*.scm $(S9DIR)
-	install $C -m 0644 ext/csv/*.scm $(S9DIR)
-	install $C -m 0644 contrib/* $(S9DIR)
-	install $C -m 0644 s9.1.gz $(MANDIR)
-	(tar cf - help | tar xfC - $(S9DIR))
-	install $C -m 0644 libs9core.a $(LIBDIR)
-	install $C -m 0644 s9core.h $(INCDIR)
-	install $C -m 0644 s9import.h $(INCDIR)
+install-s9:	s9.exe s9.scm s9.image s9.1.gz libs9core.a
+	install -d -m 0755 $(DESTDIR)$(S9DIR)
+	install -d -m 0755 $(DESTDIR)$(S9DIR)/help
+	install -d -m 0755 $(DESTDIR)$(S9DIR)/help/sys-unix
+	install -d -m 0755 $(DESTDIR)$(S9DIR)/help/curses
+	install -d -m 0755 $(DESTDIR)$(S9DIR)/help/csv
+	install -d -m 0755 $(DESTDIR)$(BINDIR)
+	install -d -m 0755 $(DESTDIR)$(LIBDIR)
+	install -d -m 0755 $(DESTDIR)$(INCDIR)
+	install -d -m 0755 $(DESTDIR)$(MANDIR)
+	install $C -m 0755 s9.exe $(DESTDIR)$(BINDIR)
+	strip $(DESTDIR)$(BINDIR)/s9.exe
+	install $C -m 0644 s9.scm $(DESTDIR)$(S9DIR)
+	install $C -m 0644 s9.image $(DESTDIR)$(S9DIR)
+	install $C -m 0644 lib/* $(DESTDIR)$(S9DIR)
+	install $C -m 0644 ext/curses/*.scm $(DESTDIR)$(S9DIR)
+	install $C -m 0644 ext/csv/*.scm $(DESTDIR)$(S9DIR)
+	install $C -m 0644 contrib/* $(DESTDIR)$(S9DIR)
+	install $C -m 0644 s9.1.gz $(DESTDIR)$(MANDIR)
+	(tar cf - help | tar xfC - $(DESTDIR)$(S9DIR))
+	install $C -m 0644 libs9core.a $(DESTDIR)$(LIBDIR)
+	install $C -m 0644 s9core.h $(DESTDIR)$(INCDIR)
+	install $C -m 0644 s9import.h $(DESTDIR)$(INCDIR)
 
 install-util:
-	$(SETPREFIX) <prog/s9help.scm >$(BINDIR)/s9help
-	$(SETPREFIX) <prog/s9resolve.scm >$(BINDIR)/s9resolve
-	$(SETPREFIX) <prog/scm2html1.scm >$(BINDIR)/scm2html
-	$(SETPREFIX) <prog/scmpp.scm >$(BINDIR)/scmpp
+	$(SETPREFIX) <prog/s9help.scm >$(DESTDIR)$(BINDIR)/s9help
+	$(SETPREFIX) <prog/s9resolve.scm >$(DESTDIR)$(BINDIR)/s9resolve
+	$(SETPREFIX) <prog/scm2html1.scm >$(DESTDIR)$(BINDIR)/scm2html
+	$(SETPREFIX) <prog/scmpp.scm >$(DESTDIR)$(BINDIR)/scmpp
 	-chmod +x $(BINDIR)/s9help	\
-		  $(BINDIR)/s9resolve	\
-		  $(BINDIR)/scm2html	\
-		  $(BINDIR)/scmpp
+		  $(DESTDIR)$(BINDIR)/s9resolve	\
+		  $(DESTDIR)$(BINDIR)/scm2html	\
+		  $(DESTDIR)$(BINDIR)/scmpp
 
 install-progs:
-	$(SETPREFIX) <prog/advgen.scm >$(BINDIR)/advgen
-	$(SETPREFIX) <prog/c2html1.scm >$(BINDIR)/c2html
-	$(SETPREFIX) <prog/cols.scm >$(BINDIR)/cols
-	$(SETPREFIX) <prog/dupes.scm >$(BINDIR)/dupes
-	$(SETPREFIX) <prog/edoc.scm.edoc >$(BINDIR)/edoc
-	$(SETPREFIX) <prog/htmlify.scm >$(BINDIR)/htmlify
-	$(SETPREFIX) <prog/s9hts.scm >$(BINDIR)/s9hts
-	$(SETPREFIX) <prog/soccat.scm >$(BINDIR)/soccat
-	-chmod +x $(BINDIR)/advgen	\
-		  $(BINDIR)/c2html	\
-		  $(BINDIR)/cols	\
-		  $(BINDIR)/dupes	\
-		  $(BINDIR)/edoc	\
-		  $(BINDIR)/htmlify	\
-		  $(BINDIR)/s9hts	\
-		  $(BINDIR)/soccat
+	$(SETPREFIX) <prog/advgen.scm >$(DESTDIR)$(BINDIR)/advgen
+	$(SETPREFIX) <prog/c2html1.scm >$(DESTDIR)$(BINDIR)/c2html
+	$(SETPREFIX) <prog/cols.scm >$(DESTDIR)$(BINDIR)/cols
+	$(SETPREFIX) <prog/dupes.scm >$(DESTDIR)$(BINDIR)/dupes
+	$(SETPREFIX) <prog/edoc.scm.edoc >$(DESTDIR)$(BINDIR)/edoc
+	$(SETPREFIX) <prog/htmlify.scm >$(DESTDIR)$(BINDIR)/htmlify
+	$(SETPREFIX) <prog/s9hts.scm >$(DESTDIR)$(BINDIR)/s9hts
+	$(SETPREFIX) <prog/soccat.scm >$(DESTDIR)$(BINDIR)/soccat
+	-chmod +x $(DESTDIR)$(BINDIR)/advgen	\
+		  $(DESTDIR)$(BINDIR)/c2html	\
+		  $(DESTDIR)$(BINDIR)/cols	\
+		  $(DESTDIR)$(BINDIR)/dupes	\
+		  $(DESTDIR)$(BINDIR)/edoc	\
+		  $(DESTDIR)$(BINDIR)/htmlify	\
+		  $(DESTDIR)$(BINDIR)/s9hts	\
+		  $(DESTDIR)$(BINDIR)/soccat
 
 deinstall:	deinstall-s9 deinstall-util deinstall-progs
 
 deinstall-s9:
 	rm -f $(S9DIR)/help/* && rmdir $(S9DIR)/help
 	rm -f $(S9DIR)/* && rmdir $(S9DIR)
-	rm -f $(BINDIR)/s9
+	rm -f $(BINDIR)/s9.exe
 	-rmdir $(BINDIR)
 	-rmdir $(MANDIR)
 
@@ -210,10 +202,10 @@
 	@find . -name \*.scm -exec grep -l "	" {} \;
 
 cd:
-	./s9 -i ./s9.image -f util/check-descr.scm
+	./s9.exe -i ./s9.image -f util/check-descr.scm
 
 clean:
-	rm -f s9 s9.image libs9core.a test.image s9.1.gz *.o *.core a.out \
+	rm -f s9.exe s9.image libs9core.a test.image s9.1.gz *.o *.core a.out \
 		CATEGORIES.html HACKING.html core s9fes-$(RELEASE).tgz \
 		s9fes-$(BASE).tgz s9core-$(RELEASE).tgz __testfile__ \
 		_meta _toc.tr _xref.tr _ndx.tr
diff -u3 -r s9.org/s9.c s9/s9.c
--- s9.org/s9.c	2025-08-12 18:57:45.000000000 +0900
+++ s9/s9.c	2025-11-20 17:01:46.765572100 +0900
@@ -9,6 +9,17 @@
 #define RELEASE_DATE	"2025-08-12"
 #define PATCHLEVEL	0
 
+#ifdef __MINGW32__
+ #include <windows.h>
+ #include <shlwapi.h>
+ #include <signal.h>
+ #include <setjmp.h>
+ #define handle_sigint()        signal(SIGINT, keyboard_interrupt)
+ #undef TRUE
+ #undef FALSE
+ #undef VOID
+#endif
+
 #include "s9core.h"
 #include "s9import.h"
 #include "s9ext.h"
@@ -26,8 +37,10 @@
 
 #define IMAGE_FILE	"s9.image"
 
-#ifndef IMAGE_DIR
- #define IMAGE_DIR	"."
+#ifndef __MINGW32__
+ #ifndef IMAGE_DIR
+  #define IMAGE_DIR	"."
+ #endif
 #endif
 
 #ifndef LIBRARY_PATH
@@ -282,7 +295,9 @@
  * Extension setup, add your own ones here
  */
 
+#ifndef __MINGW32__
 void sys_init(void);
+#endif
 void curs_init(void);
 void csv_init(void);
 
@@ -885,13 +900,41 @@
 	char	path[TOKEN_LENGTH+1], *s;
 	int	i, j;
 	cell	n, new;
+	char	prefix[TOKEN_LENGTH+1];
+	char	paths[TOKEN_LENGTH+1];
+	static char	library_path[] = "/../share/s9fes";
 
 	save(n = NIL);
 	s = getenv("S9FES_LIBRARY_PATH");
+#ifdef __MINGW32__
+	if (NULL == s) {
+		HMODULE mod = GetModuleHandleA(NULL);
+		DWORD nSize = GetModuleFileNameA(mod, prefix, sizeof(prefix));
+		if(nSize == sizeof(prefix)) {
+			error("library path too long", UNDEFINED);
+			fatal("aborting");
+		}
+		if(!PathRemoveFileSpecA(prefix)) {
+			error("library path prefix is not valid", UNDEFINED);
+			fatal("aborting");
+		}
+		if(strlen(prefix) + sizeof(library_path) + 2 >= sizeof(paths)) {
+			error("library path too long", UNDEFINED);
+			fatal("aborting");
+		}
+		sprintf(paths, ".;%s/%s", prefix, library_path);
+		s = prefix;
+	}
+#else
 	if (NULL == s) s = LIBRARY_PATH;
+#endif
 	i = j = 0;
 	for (;;) {
+#ifdef __MINGW32__
+		if ('\0' == s[i] || ';' == s[i]) {
+#else
 		if ('\0' == s[i] || ':' == s[i]) {
+#endif
 			path[j] = 0;
 			new = make_string(path, j);
 			j = 0;
@@ -1217,13 +1260,40 @@
 void load_initial_image(char *image) {
 	char	*path, pbuf[TOKEN_LENGTH+1];
 	char	*s, *imgdir;
+	char	prefix[TOKEN_LENGTH+1];
+	static char	s9dir[]="/../share/s9fes";
 
 	if (setjmp(Restart) != 0)
 		fatal("could not load S9 image or library");
 	Report_to_stderr = 1;
 	imgdir = getenv("S9FES_IMAGE_DIR");
+#ifdef __MINGW32__
+	if (NULL == imgdir) {
+		HMODULE mod = GetModuleHandleA(NULL);
+		DWORD nSize = GetModuleFileNameA(mod, prefix, sizeof(prefix));
+		if(nSize == sizeof(prefix)) {
+			error("image path too long", UNDEFINED);
+			fatal("aborting");
+		}
+		if(!PathRemoveFileSpecA(prefix)) {
+			error("image path prefix is not valid", UNDEFINED);
+			fatal("aborting");
+		}
+		if(strlen(prefix) + sizeof(s9dir) >= sizeof(prefix)) {
+			error("image path too long", UNDEFINED);
+			fatal("aborting");
+		}
+		strcat(prefix, s9dir);
+		imgdir = prefix;
+	}
+#else
 	if (NULL == imgdir) imgdir = IMAGE_DIR;
+#endif
+#ifdef __MINGW32__
+	if ('.' == *image || '/' == *image || !PathIsRelativeA(image)) {
+#else
 	if ('.' == *image || '/' == *image) {
+#endif
 		path = image;
 	}
 	else {
@@ -5459,7 +5529,7 @@
  * REPL
  */
 
-#ifdef unix
+#if defined(unix) || defined(__MINGW32__)
  void keyboard_interrupt(int sig) {
 	reset_std_ports();
 	s9_abort();
@@ -5505,7 +5575,9 @@
 
 	setjmp(Restart);
 	if (!O_quiet) handle_sigint();
+#ifndef __MINGW32__
 	handle_sigquit();
+#endif
 	mem_error_handler(mem_error);
 	for (;;) {
 		Running = 0;
diff -u3 -r s9.org/s9core.h s9/s9core.h
--- s9.org/s9core.h	2025-08-12 18:59:13.000000000 +0900
+++ s9/s9core.h	2025-11-19 13:11:22.642009400 +0900
@@ -32,19 +32,25 @@
 
 #ifdef __GNUC__
  #ifndef unix
-  #define unix
+  #ifndef __MINGW32__
+   #define unix
+  #endif
  #endif
 #endif
 
 #ifdef __clang__
  #ifndef unix
-  #define unix
+  #ifndef __MINGW32__
+   #define unix
+  #endif
  #endif
 #endif
 
 #ifndef unix
  #ifndef plan9
-  #error "Either 'unix' or 'plan9' must be #defined."
+  #ifndef __MINGW32__
+   #error "Either 'unix' or 'plan9' must be #defined."
+  #endif
  #endif
 #endif
 
@@ -70,7 +76,7 @@
  #define ptrdiff_t vlong
 #endif
 
-#ifdef unix
+#if defined(unix) || defined(__MINGW32__)
  #include <stdlib.h>
  #include <stddef.h>
  #include <stdio.h>
